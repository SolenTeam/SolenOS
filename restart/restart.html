<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SolenOS - Restarting</title>
    <link rel="stylesheet" href="restart.css">
</head>
<body>
    <div class="restart-container">
    </div>

    <script>
        // Function to close all applications
        function closeApplications() {
            // In a real system, this would close all open applications
            return new Promise(resolve => {
                setTimeout(() => {
                    resolve();
                }, 800);
            });
        }

        // Function to save settings
        function saveSettings() {
            // Save current settings to localStorage
            const existingSettings = localStorage.getItem('solenos-settings');
            if (!existingSettings) {
                localStorage.setItem('solenos-settings', JSON.stringify({
                    theme: 'modern',
                    wallpaper: 'default',
                    language: 'en'
                }));
            }
            return new Promise(resolve => {
                setTimeout(() => {
                    resolve();
                }, 600);
            });
        }

        // Function to prepare system
        function prepareSystem() {
            return new Promise(resolve => {
                setTimeout(() => {
                    resolve();
                }, 500);
            });
        }

        // Function to show wallpaper only
        function showWallpaperOnly() {
            // Hide all content except the wallpaper
            document.body.style.backgroundColor = '';
            document.body.style.backgroundImage = '';
            document.body.style.background = 'black'; // Default background

            // Try to get the saved wallpaper setting
            const savedSettings = localStorage.getItem('solenos-settings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                if (settings.wallpaper === 'mountain') {
                    document.body.style.backgroundImage = 'url("../wallpapers/mountain_wallpaper.png")';
                    document.body.style.backgroundSize = 'cover';
                    document.body.style.backgroundPosition = 'center';
                    document.body.style.backgroundRepeat = 'no-repeat';
                } else if (settings.wallpaper === 'ocean') {
                    document.body.style.backgroundImage = 'url("../wallpapers/ocean_wallpaper.png")';
                    document.body.style.backgroundSize = 'cover';
                    document.body.style.backgroundPosition = 'center';
                    document.body.style.backgroundRepeat = 'no-repeat';
                } else if (settings.wallpaper === 'default') {
                    document.body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                }
            }

            // Hide all elements except the body background
            document.querySelector('.restart-container').style.visibility = 'hidden';
            document.querySelector('.restart-container').style.position = 'absolute';
            document.querySelector('.restart-container').style.opacity = '0';

            console.log("Wallpaper only view displayed.");
            return new Promise(resolve => {
                setTimeout(() => {
                    resolve();
                }, 1000); // Show wallpaper for 1 second
            });
        }

        // Main restart process
        async function performRestart() {
            // Close applications
            await closeApplications();

            // Save settings
            await saveSettings();

            // Prepare system
            await prepareSystem();

            // Show wallpaper only
            await showWallpaperOnly();

            // Final delay before redirect
            setTimeout(() => {
                // Redirect to startup page
                window.location.href = '../startup/startup.html';
            }, 500);
        }
    

        // Start the restart process
        performRestart();
    </script>
</body>
</html>
